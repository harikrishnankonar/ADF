{
	"name": "dfbillorderHead",
	"properties": {
		"folder": {
			"name": "POS Transaction"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "dsposdata",
						"type": "DatasetReference"
					},
					"name": "dsbillorderhead"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DimBillOrderHead_Dest",
						"type": "DatasetReference"
					},
					"name": "DimBillOrderHead"
				}
			],
			"transformations": [
				{
					"name": "arbillorderhead"
				}
			],
			"script": "source(output(\n\t\tGroupID as string,\n\t\tClientID as string,\n\t\tPOSCode as string,\n\t\tPropertyCode as integer,\n\t\tRegionCode as integer,\n\t\tBrandCode as integer,\n\t\tCountryCode as integer,\n\t\tBillOrder as string,\n\t\tBillNo as string,\n\t\tBillAmount as decimal(38,8),\n\t\tBillMadeDate as timestamp,\n\t\tBillMadeTime as string,\n\t\tBillDateTime as timestamp,\n\t\tBillTime as string,\n\t\tSettleDate as timestamp,\n\t\tSettleTime as string,\n\t\tPax as integer,\n\t\tTableRoomCode as string,\n\t\tKOTType as integer,\n\t\tNCType as integer,\n\t\tSubCompType as integer,\n\t\tEmployeeCode as string,\n\t\tBillStatus as string,\n\t\tKOTStyle as integer,\n\t\tBillMadeBy as string,\n\t\tBillSettledBy as string,\n\t\tTotalTax as decimal(38,8),\n\t\tStaffCode as string,\n\t\tAuthBy as string,\n\t\tTotalDiscount as decimal(38,8),\n\t\tRoundOffAmount as decimal(38,8),\n\t\tCashTipAmount as decimal(38,8),\n\t\tCashReturnAmount as decimal(38,8),\n\t\tOverCounter as string,\n\t\tDiplomat as string,\n\t\tComplimentory as decimal(38,8),\n\t\tComplimentoryType as integer,\n\t\tComplimentorySubType as integer,\n\t\tPayMode as string,\n\t\tPaymodeDescription as string,\n\t\tPartyCode as integer,\n\t\tPartyName as string,\n\t\tPermitNo as string,\n\t\tPermitHolder as string,\n\t\tExpiryDate as timestamp,\n\t\tResident as boolean,\n\t\tReasonCode as integer,\n\t\tWaiterCode as string,\n\t\tGeneralRemark as string,\n\t\tRoomNo as string,\n\t\tGuestName as string,\n\t\tRegistrationNo as string,\n\t\tVoucherNo as string,\n\t\tDineInOut as integer,\n\t\tAdditionalCharge as decimal(18,8),\n\t\tAdditionalChargeCode as string,\n\t\tAdditionalChargeDescription as string,\n\t\tAdvanceAdjustedAmount as decimal(38,8),\n\t\tVoidReasonCode as integer,\n\t\tVoidType as string,\n\t\tTotalTipAmount as decimal(38,8),\n\t\tPayCash as boolean,\n\t\tPayCreditCard as boolean,\n\t\tPayCompliment as boolean,\n\t\tBillSettleDateTime as timestamp,\n\t\tBillMadeDateTime as timestamp,\n\t\tOrderFrom as string,\n\t\tMemberShipCode as string,\n\t\tMemberCode as string,\n\t\tMemberName as string,\n\t\tIntOrExt as boolean,\n\t\tDiplomatID as string,\n\t\tDiscCardCode as integer,\n\t\tDiscCardDetailsCode as integer,\n\t\tBillSettledShift as integer,\n\t\tBillMadeShift as integer,\n\t\tDiscountRemark as string,\n\t\tUpdFrm as string,\n\t\tDiscountCardNo as string,\n\t\tCustomerName as string,\n\t\tMinKotNo as string,\n\t\tMinKotDateTime as timestamp,\n\t\tMaxKotNo as string,\n\t\tMaxKotDateTime as timestamp,\n\t\tParentBillNo as string,\n\t\tBackwardIndicator as string,\n\t\tComplimentoryRemark as string,\n\t\tPaymodeKeyCode as string,\n\t\tFABR as boolean,\n\t\tTHV as boolean,\n\t\tPOSCodeTo as string,\n\t\tISSplit as boolean,\n\t\tOptionNeumonic as string,\n\t\tRptOptionNeumonic as string,\n\t\treservationNo as string,\n\t\tGSTINNumber as string,\n\t\tGSTCustName as string,\n\t\tGSTCustAddress as string,\n\t\tGSTCustStateCode as string,\n\t\tCompanyACCode as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'Select   \\'002\\' GroupID\\n, \\'000\\' ClientID\\n, isnull(t4.POSCode,\\'\\') POSCode\\n, isnull(t4.PropertyCode,0) PropertyCode\\n, isnull(t4.RegionCode,0) RegionCode\\n, isnull(t4.BrandCode,0) BrandCode\\n, isnull(t4.CountryCode,0) CountryCode\\n, isnull(t4.BillOrder,\\'\\') BillOrder\\n, isnull(t4.BillNo,\\'\\') BillNo\\n, isnull(t4.BillAmount,0) BillAmount\\n, isnull(t4.BillMadeDate,\\'1900-01-01\\') BillMadeDate\\n, isnull(t4.BillMadeTime,\\'00:00:00\\') BillMadeTime\\n, isnull(t4.BillDateTime,\\'1900-01-01\\') BillDateTime\\n, isnull(t4.BillTime,\\'00:00:00\\') BillTime\\n, isnull(t4.SettleDate,\\'1900-01-01\\') SettleDate\\n, isnull(t4.SettleTime,\\'00:00:00\\') SettleTime\\n--, Replace(left(isnull(t4.SettleTime,\\'00:00:00\\'),4),\\':\\',\\'.\\') SettleTime1\\n, isnull(t4.Pax,0) Pax\\n, isnull(t4.TableRoomCode,\\'\\') TableRoomCode\\n, isnull(t4.KOTType,0) KOTType\\n, isnull(t4.NCType,0) NCType\\n, isnull(t4.SubCompType,0) SubCompType\\n, isnull(t4.EmployeeCode,\\'\\') EmployeeCode\\n, isnull(t4.BillStatus,\\'\\') BillStatus\\n, isnull(t4.KOTStyle,0) KOTStyle\\n, isnull(t4.BillMadeBy,\\'\\') BillMadeBy\\n, isnull(t4.BillSettledBy,\\'\\') BillSettledBy\\n, isnull(t4.TotalTax,0) TotalTax\\n, isnull(t4.StaffCode,\\'\\') StaffCode\\n, isnull(t4.AuthBy,\\'\\')  AuthBy\\n, isnull(t4.TotalDiscount,0) TotalDiscount\\n, isnull(t4.RoundOffAmount,0) RoundOffAmount\\n, isnull(t4.CashTipAmount,0) CashTipAmount\\n, isnull(t4.CashReturnAmount,0) CashReturnAmount\\n, isnull(t4.OverCounter,\\'\\') OverCounter\\n, isnull(t4.Diplomat,\\'\\') Diplomat\\n, isnull(t4.Complimentory,0) Complimentory\\n, isnull(t4.ComplimentoryType,0) ComplimentoryType\\n, isnull(t4.ComplimentorySubType,0) ComplimentorySubType\\n, isnull(t4.Paymode,\\'\\') PayMode\\n, isnull(t4.PaymodeDescription,\\'\\') PaymodeDescription\\n, isnull(t4.PartyCode,0) PartyCode\\n, isnull(t4.PartyName,\\'\\') PartyName\\n, isnull(t4.PermitNo,\\'\\') PermitNo\\n, isnull(t4.PermitHolder,\\'\\') PermitHolder\\n, isnull(t4.ExpiryDate,\\'\\') ExpiryDate\\n, isnull(t4.Resident,0) Resident\\n, isnull(t4.ReasonCode,0) ReasonCode\\n, isnull(t4.WaiterCode,\\'\\') WaiterCode\\n, isnull(t4.GeneralRemark,\\'\\') GeneralRemark\\n, isnull(t4.RoomNo,\\'\\') RoomNo\\n, isnull(t4.GuestName,\\'\\') GuestName\\n, isnull(t4.RegistrationNo,\\'\\') RegistrationNo\\n, isnull(t4.VoucherNo,\\'\\') VoucherNo\\n, isnull(t4.DineInOut,0) DineInOut \\n, isnull(t4.AdditionalCharge,0) AdditionalCharge\\n, isnull(t4.AdditionalChargeCode, \\'\\') AdditionalChargeCode\\n, isnull(t4.AdditionalChargeDescription,\\'\\') AdditionalChargeDescription\\n, isnull(t4.AdvanceAdjustedAmount,0) AdvanceAdjustedAmount\\n, isnull(t4.VoidReasonCode,0) VoidReasonCode\\n, isnull(t4.VoidType,\\'\\') VoidType\\n, isnull(t4.TotalTipAmount,0) TotalTipAmount\\n, isnull(t4.PayCash,0) PayCash\\n, isnull(t4.PayCreditCard,0) PayCreditCard\\n, isnull(t4.PayCompliment,0) PayCompliment\\n, Cast(isnull(t4.SettleDate,\\'1900-01-01\\') as DateTime)+Cast(isnull(t4.SettleTime,\\'00:00:00 AM\\') as DateTime) BillSettleDateTime\\n, Cast(isnull(t4.BillMadeDate,\\'1900-01-01\\') as DateTime)+Cast(isnull(t4.BillMadeTime,\\'00:00:00 AM\\') as DateTime) BillMadeDateTime\\n, ISNULL(t4.OrderFrom,\\'0\\') OrderFrom\\n, isnull(t4.MemberShipCode,\\'\\') MemberShipCode\\n, isnull(t4.MemberCode,\\'\\') MemberCode\\n, isnull(t4.MemberName,\\'\\') MemberName\\n, isnull(t4.IntOrExt,0) IntOrExt\\n, isnull(t4.DiplomatID,\\'\\') DiplomatID\\n, IsNull(t4.DiscountCardCode,0) DiscCardCode\\n, IsNull(t4.DiscountCardDetailsCode,0) DiscCardDetailsCode\\n, IsNull(t4.BillSettledShift,0) as BillSettledShift\\n, IsNull(t4.BillMadeShift,0) as BillMadeShift\\n, IsNull(t4.DiscountRemark,\\'\\') as DiscountRemark\\n, IsNull(t4.UpdFrm,\\'\\') as UpdFrm\\n, isnull(t4.DiscountCardNo,\\'\\') DiscountCardNo\\n, isnull(t4.CustomerName,\\'\\') CustomerName\\n, isnull(t5.MinKotNo,\\'\\') MinKotNo\\n, isnull(t5.MinKotDateTime,\\'1900-01-01\\') MinKotDateTime\\n, isnull(t5.MaxKotNo,\\'\\') MaxKotNo\\n, isnull(t5.MaxKotDateTime,\\'1900-01-01\\') MaxKotDateTime\\n, isnull(t4.ParentBillNo,\\'\\') ParentBillNo\\n, isnull(t4.BackwardIndicator,\\'\\') BackwardIndicator\\n, isnull(t4.ComplimentoryRemark,\\'\\') ComplimentoryRemark\\n, isnull(t4.PaymodeKeyCode,\\'\\') PaymodeKeyCode\\n, isnull(t4.FABR,\\'\\') FABR\\n, isnull(t4.THV,\\'\\') THV\\n, isnull(t4.POSCodeTo,\\'\\') POSCodeTo\\n, isnull(t4.ISSplit,\\'\\') ISSplit\\n, isnull(t4.OptionNeumonic,\\'\\') OptionNeumonic\\n, isnull(t4.RptOptionNeumonic,\\'\\') RptOptionNeumonic\\n, Left(isnull(t4.reservationNo,\\'\\'),200) reservationNo\\n, isnull(t4.GSTINNumber,\\'\\') GSTINNumber\\n, isnull(t4.GSTCustName,\\'\\') GSTCustName\\n, Left(isnull(t4.GSTCustAddress,\\'\\'),250) GSTCustAddress\\n, isnull(t4.GSTCustStateCode,\\'\\') GSTCustStateCode\\n, isnull(t4.CompanyACCode,\\'\\') CompanyACCode\\nFrom QFile.tblBillOrderHead t4 with(nolock) \\nleft outer join \\n(Select t1.POSCode, t1.BillMadeDateTime, t1.BillNo, t1.MinKotNo, t2.KotdateTime MinKotDateTime, t1.MaxKotNo, t3.KotDateTime MaxKotDateTime from\\n(select PosCode, isnull(BillMadeDateTime,\\'1900-01-01\\') BillMadeDateTime, isnull(BillNo,\\'\\') BillNo, MIN(isnull(KotNo,\\'\\')) MinKotNo, MAX(isnull(KotNo,\\'\\')) MaxKotNo from QFile.tblBillOrderLink with(nolock) group by POSCode, BillMadeDateTime, BillNo) t1\\nleft outer join \\n(select Poscode, BillMadeDate KotDate, BillNo KotNo, BillDateTime KOTDateTime from QFile.tblBillOrderHead with(nolock) where BillOrder= \\'K\\') t2 on t1.Poscode = t2.Poscode and t1.BillMadeDateTime = t2.KotDate and t1.MinKotNo = t2.KotNo\\nleft outer join \\n(select Poscode, BillMadeDate KotDate, BillNo KotNo, BillDateTime KOTDateTime from QFile.tblBillOrderHead with(nolock) where BillOrder= \\'K\\') t3 on t1.Poscode = t3.Poscode and t1.BillMadeDateTime = t3.KotDate and t1.MaxKotNo = t3.KotNo) t5 on t4.POSCode = t5.POSCode and t4.BillMadeDate = t5.BillMadeDateTime and t4.BillNo = t5.BillNo\\nWhere t4.billorder = \\'B\\' and t4.BillStatus = \\'S\\'',\n\tformat: 'query') ~> dsbillorderhead\ndsbillorderhead alterRow(insertIf(true())) ~> arbillorderhead\narbillorderhead sink(input(\n\t\tBillOrderHeadID as integer,\n\t\tGroupId as string,\n\t\tClientId as string,\n\t\tPOSCode as string,\n\t\tPropertyCode as integer,\n\t\tRegionCode as integer,\n\t\tBrandCode as integer,\n\t\tCountryCode as integer,\n\t\tBillOrder as string,\n\t\tParentBillNo as string,\n\t\tBillNo as string,\n\t\tBillAmount as decimal(38,8),\n\t\tBillMadeDate as timestamp,\n\t\tBillMadeTime as string,\n\t\tBillDateTime as timestamp,\n\t\tBillTime as string,\n\t\tSettleDate as timestamp,\n\t\tSettleTime as string,\n\t\tPax as integer,\n\t\tTableRoomCode as string,\n\t\tKOTType as integer,\n\t\tNCType as integer,\n\t\tSubCompType as integer,\n\t\tEmployeeCode as string,\n\t\tBillStatus as string,\n\t\tKOTStyle as integer,\n\t\tBillMadeBy as string,\n\t\tBillSettledBy as string,\n\t\tBillMadeShift as integer,\n\t\tBillSettledShift as integer,\n\t\tBackwardIndicator as string,\n\t\tTotalTax as decimal(38,8),\n\t\tStaffCode as string,\n\t\tAuthBy as string,\n\t\tTotalDiscount as decimal(38,8),\n\t\tRoundOffAmount as decimal(38,8),\n\t\tPayCash as boolean,\n\t\tPayCreditCard as boolean,\n\t\tPayDebitCard as boolean,\n\t\tPayForeign as boolean,\n\t\tPayCheque as boolean,\n\t\tPayMember as boolean,\n\t\tPayCLP as boolean,\n\t\tPayParty as boolean,\n\t\tPayGV as boolean,\n\t\tPayCoupon as boolean,\n\t\tPayRoom as boolean,\n\t\tPayStaff as boolean,\n\t\tPayCompliment as boolean,\n\t\tPayTransOut as boolean,\n\t\tPayCashAmount as decimal(38,8),\n\t\tCashTipAmount as decimal(38,8),\n\t\tCashReturnAmount as decimal(38,8),\n\t\tOverCounter as string,\n\t\tDiplomat as string,\n\t\tComplimentory as decimal(38,8),\n\t\tComplimentoryType as integer,\n\t\tComplimentorySubType as integer,\n\t\tComplimentoryRemark as string,\n\t\tPaymode as string,\n\t\tPaymodeKeyCode as string,\n\t\tPaymodeDescription as string,\n\t\tPartyCode as integer,\n\t\tPartyName as string,\n\t\tPermitNo as string,\n\t\tPermitHolder as string,\n\t\tExpiryDate as timestamp,\n\t\tResident as boolean,\n\t\tFABR as boolean,\n\t\tTHV as boolean,\n\t\tPOSCodeTo as string,\n\t\tReasonCode as integer,\n\t\tDiscCardCode as integer,\n\t\tDiscCardDetailsCode as integer,\n\t\tCustomerName as string,\n\t\tDiscountRemark as string,\n\t\tWaiterCode as string,\n\t\tGeneralRemark as string,\n\t\tRoomNo as string,\n\t\tGuestName as string,\n\t\tRegistrationNo as string,\n\t\tISSplit as boolean,\n\t\tVoucherNo as string,\n\t\tDineInOut as integer,\n\t\tOrderFrom as string,\n\t\tOptionNeumonic as string,\n\t\tRptOptionNeumonic as string,\n\t\tUpdFrm as string,\n\t\tMemberShipCode as string,\n\t\tMemberCode as string,\n\t\tMemberName as string,\n\t\tIntOrExt as boolean,\n\t\tDiplomatID as string,\n\t\tDiscountCardNo as string,\n\t\tAdditionalCharge as decimal(18,8),\n\t\tAdditionalChargeCode as string,\n\t\tAdditionalChargeDescription as string,\n\t\tAdvanceAdjustedAmount as decimal(38,8),\n\t\tVoidReasonCode as integer,\n\t\tVoidType as string,\n\t\tTotalTipAmount as decimal(38,8),\n\t\tCustomerCode as string,\n\t\tAddress1 as string,\n\t\tAddress2 as string,\n\t\tTelephone1 as string,\n\t\tTelephone2 as string,\n\t\tMobile1 as string,\n\t\tMobile2 as string,\n\t\treservationNo as string,\n\t\tGSTINNumber as string,\n\t\tGSTCustName as string,\n\t\tGSTCustAddress as string,\n\t\tGSTCustStateCode as string,\n\t\tCompanyACCode as integer,\n\t\tCreatedDate as timestamp,\n\t\tCreatedBy as string,\n\t\tAuditDt as timestamp,\n\t\tMaxKotDateTime as timestamp,\n\t\tMaxKotNo as string,\n\t\tBillMadeDateTime as timestamp,\n\t\tBillSettleDateTime as timestamp,\n\t\tMinKotDateTime as timestamp,\n\t\tMinKotNo as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tmapColumn(\n\t\tGroupId = GroupID,\n\t\tClientId = ClientID,\n\t\tPOSCode,\n\t\tPropertyCode,\n\t\tRegionCode,\n\t\tBrandCode,\n\t\tCountryCode,\n\t\tBillOrder,\n\t\tParentBillNo,\n\t\tBillNo,\n\t\tBillAmount,\n\t\tBillMadeDate,\n\t\tBillMadeTime,\n\t\tBillDateTime,\n\t\tBillTime,\n\t\tSettleDate,\n\t\tSettleTime,\n\t\tPax,\n\t\tTableRoomCode,\n\t\tKOTType,\n\t\tNCType,\n\t\tSubCompType,\n\t\tEmployeeCode,\n\t\tBillStatus,\n\t\tKOTStyle,\n\t\tBillMadeBy,\n\t\tBillSettledBy,\n\t\tBillMadeShift,\n\t\tBillSettledShift,\n\t\tBackwardIndicator,\n\t\tTotalTax,\n\t\tStaffCode,\n\t\tAuthBy,\n\t\tTotalDiscount,\n\t\tRoundOffAmount,\n\t\tPayCash,\n\t\tPayCreditCard,\n\t\tPayCompliment,\n\t\tCashTipAmount,\n\t\tCashReturnAmount,\n\t\tOverCounter,\n\t\tDiplomat,\n\t\tComplimentory,\n\t\tComplimentoryType,\n\t\tComplimentorySubType,\n\t\tComplimentoryRemark,\n\t\tPaymode = PayMode,\n\t\tPaymodeKeyCode,\n\t\tPaymodeDescription,\n\t\tPartyCode,\n\t\tPartyName,\n\t\tPermitNo,\n\t\tPermitHolder,\n\t\tExpiryDate,\n\t\tResident,\n\t\tFABR,\n\t\tTHV,\n\t\tPOSCodeTo,\n\t\tReasonCode,\n\t\tDiscCardCode,\n\t\tDiscCardDetailsCode,\n\t\tCustomerName,\n\t\tDiscountRemark,\n\t\tWaiterCode,\n\t\tGeneralRemark,\n\t\tRoomNo,\n\t\tGuestName,\n\t\tRegistrationNo,\n\t\tISSplit,\n\t\tVoucherNo,\n\t\tDineInOut,\n\t\tOrderFrom,\n\t\tOptionNeumonic,\n\t\tRptOptionNeumonic,\n\t\tUpdFrm,\n\t\tMemberShipCode,\n\t\tMemberCode,\n\t\tMemberName,\n\t\tIntOrExt,\n\t\tDiplomatID,\n\t\tDiscountCardNo,\n\t\tAdditionalCharge,\n\t\tAdditionalChargeCode,\n\t\tAdditionalChargeDescription,\n\t\tAdvanceAdjustedAmount,\n\t\tVoidReasonCode,\n\t\tVoidType,\n\t\tTotalTipAmount,\n\t\treservationNo,\n\t\tGSTINNumber,\n\t\tGSTCustName,\n\t\tGSTCustAddress,\n\t\tGSTCustStateCode,\n\t\tCompanyACCode,\n\t\tMaxKotDateTime,\n\t\tMaxKotNo,\n\t\tBillMadeDateTime,\n\t\tBillSettleDateTime,\n\t\tMinKotDateTime,\n\t\tMinKotNo\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> DimBillOrderHead"
		}
	}
}