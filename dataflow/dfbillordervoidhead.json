{
	"name": "dfbillordervoidhead",
	"properties": {
		"folder": {
			"name": "POS Transaction"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "dsposdata",
						"type": "DatasetReference"
					},
					"name": "dsbillordervoidhead"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DimBillOrderVoidHead_Dest",
						"type": "DatasetReference"
					},
					"name": "DimBillOrderVoidHead"
				}
			],
			"transformations": [
				{
					"name": "arbillordervoidhead"
				}
			],
			"script": "source(output(\n\t\tGroupID as string,\n\t\tClientID as string,\n\t\tPOSCode as string,\n\t\tPropertyCode as integer,\n\t\tRegionCode as integer,\n\t\tBrandCode as integer,\n\t\tCountryCode as integer,\n\t\tBillOrder as string,\n\t\tBillNo as string,\n\t\tBillAmount as decimal(38,8),\n\t\tBillMadeDate as timestamp,\n\t\tBillMadeTime as string,\n\t\tBillDateTime as timestamp,\n\t\tBillTime as string,\n\t\tSettleDate as timestamp,\n\t\tSettleTime as string,\n\t\tSettleTime1 as string,\n\t\tPax as integer,\n\t\tTableRoomCode as string,\n\t\tKOTType as integer,\n\t\tNCType as integer,\n\t\tSubCompType as integer,\n\t\tEmployeeCode as string,\n\t\tBillStatus as string,\n\t\tKOTStyle as integer,\n\t\tBillMadeBy as string,\n\t\tBillVoidBy as string,\n\t\tTotalTax as decimal(38,8),\n\t\tStaffCode as string,\n\t\tTotalDiscount as decimal(38,8),\n\t\tRoundOffAmount as decimal(38,8),\n\t\tCashTipAmount as decimal(38,8),\n\t\tCashReturnAmount as decimal(38,8),\n\t\tOverCounter as string,\n\t\tDiplomat as string,\n\t\tComplimentory as decimal(38,8),\n\t\tComplimentoryType as integer,\n\t\tPayMode as string,\n\t\tPaymodeDescription as string,\n\t\tPartyCode as integer,\n\t\tPartyName as string,\n\t\tReasonCode as integer,\n\t\tWaiterCode as string,\n\t\tAdditionalCharge as decimal(18,8),\n\t\tVoidReasonCode as integer,\n\t\tVoidType as string,\n\t\tTotalTipAmount as decimal(38,8),\n\t\tPayCash as boolean,\n\t\tPayCreditCard as boolean,\n\t\tBillSettleDateTime as timestamp,\n\t\tBillMadeDateTime as timestamp,\n\t\tPayCompliment as boolean,\n\t\tOrderFrom as string,\n\t\tDiscCardCode as integer,\n\t\tDiscCardDetailsCode as integer,\n\t\tShiftCode as integer,\n\t\tBillMadeShift as integer,\n\t\tMemberCode as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'Select \\'002\\' GroupID, \\n\\'000\\' ClientID,\\nisnull(t4.POSCode,\\'\\') POSCode, \\nisnull(t4.PropertyCode,0) PropertyCode, \\nisnull(t4.RegionCode,0) RegionCode, \\nisnull(t4.BrandCode,0) BrandCode, \\nisnull(t4.CountryCode,0) CountryCode, \\nisnull(t4.BillOrder,\\'\\') BillOrder, \\nisnull(t4.BillNo,\\'\\') BillNo, \\nisnull(t4.BillAmount,0) BillAmount, \\nisnull(t4.BillMadeDate,\\'1900-01-01\\') BillMadeDate, \\nisnull(t4.BillMadeTime,\\'00:00:00\\') BillMadeTime, \\nisnull(t4.BillDateTime,\\'1900-01-01\\') BillDateTime, \\nisnull(t4.BillTime,\\'00:00:00\\') BillTime, \\nisnull(t4.CreatedDate,\\'1900-01-01\\') SettleDate, \\nisnull(t4.SettleTime,\\'00:00:00\\') SettleTime, \\nReplace(left(isnull(t4.SettleTime,\\'00:00:00\\'),4),\\':\\',\\'.\\') SettleTime1, \\nisnull(t4.Pax,0) Pax, \\nisnull(t4.TableRoomCode,\\'\\') TableRoomCode, \\nisnull(t4.KOTType,0) KOTType, \\nisnull(t4.NCType,0) NCType, \\nisnull(t4.SubCompType,0) SubCompType, \\nisnull(t4.EmployeeCode,\\'\\') EmployeeCode, \\nisnull(t4.BillStatus,\\'\\') BillStatus,\\nisnull(t4.KOTStyle,0) KOTStyle, \\nisnull(t4.BillMadeBy,\\'\\') BillMadeBy, \\nisnull(t4.CreatedBy,\\'\\') BillVoidBy, \\nisnull(t4.TotalTax,0) TotalTax, \\nisnull(t4.StaffCode,\\'\\') StaffCode, \\nisnull(t4.TotalDiscount,0) TotalDiscount, \\nisnull(t4.RoundOffAmount,0) RoundOffAmount, \\nisnull(t4.CashTipAmount,0) CashTipAmount, \\nisnull(t4.CashReturnAmount,0) CashReturnAmount, \\nisnull(t4.OverCounter,\\'\\') OverCounter, \\nisnull(t4.Diplomat,\\'\\') Diplomat, \\nisnull(t4.Complimentory,0) Complimentory, \\nisnull(t4.ComplimentoryType,0) ComplimentoryType, \\nisnull(t4.Paymode,\\'\\') PayMode, \\nisnull(t4.PaymodeDescription,\\'\\') PaymodeDescription, \\nisnull(t4.PartyCode,0) PartyCode, \\nisnull(t4.PartyName,\\'\\') PartyName, \\nisnull(t4.ReasonCode,0) ReasonCode, \\nisnull(t4.WaiterCode,\\'\\') WaiterCode, \\nISnull(AdditionalCharge,0) as AdditionalCharge,\\nisnull(t4.VoidReasonCode,0) VoidReasonCode, \\nisnull(t4.VoidType,\\'\\') VoidType, \\nisnull(t4.TotalTipAmount,0) TotalTipAmount, \\nisnull(t4.PayCash,0) PayCash, \\nisnull(t4.PayCreditCard,0) PayCreditCard, \\nCast(isnull(t4.SettleDate,\\'1900-01-01\\') as DateTime)+Cast(isnull(t4.SettleTime,\\'00:00:00 AM\\') as DateTime) BillSettleDateTime, \\nCast(isnull(t4.BillMadeDate,\\'1900-01-01\\') as DateTime)+Cast(isnull(t4.BillMadeTime,\\'00:00:00 AM\\') as DateTime) BillMadeDateTime,\\nisnull(t4.PayCompliment,0) PayCompliment, \\nISNULL(t4.OrderFrom,\\'0\\') OrderFrom,\\nIsNull(t4.DiscountCardCode,0) DiscCardCode,\\nIsNull(t4.DiscountCardDetailsCode,0) DiscCardDetailsCode,\\nIsNull(t4.BillSettledShift,0) as ShiftCode,\\nIsNull(t4.BillMadeShift,0) as BillMadeShift,\\nisnull(t4.MemberCode,\\'\\') MemberCode\\nFrom QFile.TblBillOrderHead t4 with(nolock) \\nWhere  IsNull(t4.VoidType,\\'\\') <> \\'\\'',\n\tformat: 'query') ~> dsbillordervoidhead\ndsbillordervoidhead alterRow(insertIf(true())) ~> arbillordervoidhead\narbillordervoidhead sink(input(\n\t\tBillOrderVoidHeadID as integer,\n\t\tGroupId as string,\n\t\tClientId as string,\n\t\tPOSCode as string,\n\t\tPropertyCode as integer,\n\t\tRegionCode as integer,\n\t\tBrandCode as integer,\n\t\tCountryCode as integer,\n\t\tBillOrder as string,\n\t\tBillNo as string,\n\t\tBillAmount as decimal(38,8),\n\t\tBillMadeDate as timestamp,\n\t\tBillMadeTime as string,\n\t\tBillDateTime as timestamp,\n\t\tBillTime as string,\n\t\tSettleDate as timestamp,\n\t\tSettleTime as string,\n\t\tPax as integer,\n\t\tTableRoomCode as string,\n\t\tKOTType as integer,\n\t\tNCType as integer,\n\t\tSubCompType as integer,\n\t\tEmployeeCode as string,\n\t\tBillStatus as string,\n\t\tKOTStyle as integer,\n\t\tBillMadeBy as string,\n\t\tBillVoidBy as string,\n\t\tTotalTax as decimal(38,8),\n\t\tStaffCode as string,\n\t\tAuthBy as string,\n\t\tTotalDiscount as decimal(38,8),\n\t\tRoundOffAmount as decimal(38,8),\n\t\tCashTipAmount as decimal(38,8),\n\t\tCashReturnAmount as decimal(38,8),\n\t\tOverCounter as string,\n\t\tDiplomat as string,\n\t\tComplimentory as decimal(38,8),\n\t\tComplimentoryType as integer,\n\t\tComplimentorySubType as integer,\n\t\tPaymode as string,\n\t\tPaymodeDescription as string,\n\t\tPartyCode as integer,\n\t\tPartyName as string,\n\t\tPermitNo as string,\n\t\tPermitHolder as string,\n\t\tExpiryDate as timestamp,\n\t\tResident as boolean,\n\t\tReasonCode as integer,\n\t\tWaiterCode as string,\n\t\tRoomNo as string,\n\t\tVoucherNo as string,\n\t\tDineInOut as integer,\n\t\tAdditionalCharge as decimal(18,8),\n\t\tAdditionalChargeCode as string,\n\t\tAdditionalChargeDescription as string,\n\t\tAdvanceAdjustedAmount as decimal(38,8),\n\t\tVoidReasonCode as integer,\n\t\tVoidType as string,\n\t\tTotalTipAmount as decimal(38,8),\n\t\tPayCash as boolean,\n\t\tPayCreditCard as boolean,\n\t\tBillSettleDateTime as timestamp,\n\t\tBillMadeDateTime as timestamp,\n\t\tMinKotNo as string,\n\t\tMaxKotNo as string,\n\t\tMinKotDateTime as timestamp,\n\t\tMaxKotDateTime as timestamp,\n\t\tPayCompliment as integer,\n\t\tOrderFrom as string,\n\t\tDiscCardCode as integer,\n\t\tDiscCardDetailsCode as integer,\n\t\tShiftCode as integer,\n\t\tBillMadeShift as integer,\n\t\tMemberCode as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tmapColumn(\n\t\tGroupId = GroupID,\n\t\tClientId = ClientID,\n\t\tPOSCode,\n\t\tPropertyCode,\n\t\tRegionCode,\n\t\tBrandCode,\n\t\tCountryCode,\n\t\tBillOrder,\n\t\tBillNo,\n\t\tBillAmount,\n\t\tBillMadeDate,\n\t\tBillMadeTime,\n\t\tBillDateTime,\n\t\tBillTime,\n\t\tSettleDate,\n\t\tSettleTime,\n\t\tPax,\n\t\tTableRoomCode,\n\t\tKOTType,\n\t\tNCType,\n\t\tSubCompType,\n\t\tEmployeeCode,\n\t\tBillStatus,\n\t\tKOTStyle,\n\t\tBillMadeBy,\n\t\tBillVoidBy,\n\t\tTotalTax,\n\t\tStaffCode,\n\t\tTotalDiscount,\n\t\tRoundOffAmount,\n\t\tCashTipAmount,\n\t\tCashReturnAmount,\n\t\tOverCounter,\n\t\tDiplomat,\n\t\tComplimentory,\n\t\tComplimentoryType,\n\t\tPaymode = PayMode,\n\t\tPaymodeDescription,\n\t\tPartyCode,\n\t\tPartyName,\n\t\tReasonCode,\n\t\tWaiterCode,\n\t\tAdditionalCharge,\n\t\tVoidReasonCode,\n\t\tVoidType,\n\t\tTotalTipAmount,\n\t\tPayCash,\n\t\tPayCreditCard,\n\t\tBillSettleDateTime,\n\t\tBillMadeDateTime,\n\t\tOrderFrom,\n\t\tDiscCardCode,\n\t\tDiscCardDetailsCode,\n\t\tShiftCode,\n\t\tBillMadeShift,\n\t\tMemberCode\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> DimBillOrderVoidHead"
		}
	}
}