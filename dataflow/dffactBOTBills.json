{
	"name": "dffactBOTBills",
	"properties": {
		"folder": {
			"name": "BOT Master"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "dsdwsourcedb",
						"type": "DatasetReference"
					},
					"name": "dsfactbotbills"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "FactBOTBillNo_Dest",
						"type": "DatasetReference"
					},
					"name": "FactBOTBills"
				}
			],
			"transformations": [],
			"script": "source(output(\n\t\tDimBOTBillNoID as integer,\n\t\tDimReservationId as integer,\n\t\tReservedDateId as integer,\n\t\tBillDateTimeId as integer,\n\t\tBillAmount as decimal(38,8),\n\t\tPaymentModeID as integer,\n\t\tPOSID as integer,\n\t\tDimFloorID as integer,\n\t\tGuestID as integer,\n\t\tDimBookerID as integer,\n\t\tDimMealStructureId as integer,\n\t\tPax as integer,\n\t\tVisitsCount as integer,\n\t\tDimEventID as integer,\n\t\tDimFlagID as integer,\n\t\tActualPax as integer,\n\t\tDimStatusID as integer,\n\t\tResvCancelID as integer,\n\t\tDimReasonID as integer,\n\t\tWalkInID as integer,\n\t\tLastVisitedId as integer,\n\t\tDaysNotVisitedID as integer,\n\t\tVisitStatusID as integer,\n\t\tGuestRatingID as integer,\n\t\tReservationHourID as integer,\n\t\tGroupSizeId as integer,\n\t\tDimBookinGsourceId as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'Select T0.DimBOTBillNoID\\n\t,IsNull(T1.DimReservationId,0) as DimReservationId\\n\t,IsNull(T19.DateTimeID,0) as ReservedDateId\\n\t,ISNull(T18.DateTimeID,0) as BillDateTimeId\\n\t,IsNull(T0.BillAmount,0) as BillAmount\\n\t,IsNull(T17.PaymentModeID,0) as PaymentModeID\\n\t,isnull(t2.POSID,0) POSID, \\n\tisnull(t3.DimFloorId,0) DimFloorID,\\n\tisnull(t4.GuestID,0) GuestID,\\n\tisnull(t5.DimBookerID,0) DimBookerID,\\n\tisnull(t6.DimMealStructureId,0) DimMealStructureId,\\n\tt1.Pax,\\n\t1 VisitsCount,\\n\tisnull(t8.DimEventID,0) DimEventID,\\n\tisnull(t9.DimFlagId,0) DimFlagID,\\n\tt1.ActualPax,\\n\tisnull(t10.DimStatusID,0) DimStatusID,\\n\tisnull(t12.ResvCancelID,0) ResvCancelID,\\n\tisnull(t11.DimReasonID,0) DimReasonID,\\n\tisnull(t13.WalkInID,0) WalkInID,\\n                isnull(t14.LastVisitedId,0) LastVisitedId,\\n\tCase \\n\twhen t14.DaysNotVisited >= 31 and t14.DaysNotVisited <= 60 then 1\\n\twhen t14.DaysNotVisited >= 61 and t14.DaysNotVisited <= 90 then 2\\n\twhen t14.DaysNotVisited >= 91 and t14.DaysNotVisited <= 120 then 3\\n\twhen t14.DaysNotVisited >= 121 and t14.DaysNotVisited <= 150 then 4\\n\twhen t14.DaysNotVisited >= 151 and t14.DaysNotVisited <= 180 then 5\\n\twhen t14.DaysNotVisited >= 181 and t14.DaysNotVisited <= 270 then 6\\n\twhen t14.DaysNotVisited >= 271 and t14.DaysNotVisited <= 365 then 7\\n\twhen t14.DaysNotVisited >= 366 then 8\\n\telse 0 \\n\tEnd as DaysNotVisitedID,\\n\tCase \\n\twhen t14.VisitCount >= 1 and t14.VisitCount <= 1 then 1\\n\twhen t14.VisitCount >= 2 and t14.VisitCount <= 9 then 2\\n\twhen t14.VisitCount >= 10 and t14.VisitCount <= 50 then 3\\n\twhen t14.VisitCount >= 51 then 4\\n\telse 0 \\n\tEnd as VisitStatusID,\\n\tisnull(t15.GuestRatingID,0) GuestRatingID,\\n\tCase \\n\twhen t1.FromTime >= 0.0 and t1.FromTime <= 1.0 then 1\\n\twhen t1.FromTime >= 1.0 and t1.FromTime <= 2.0 then 2\\n\twhen t1.FromTime >= 2.0 and t1.FromTime <= 3.0 then 3\\n\twhen t1.FromTime >= 3.0 and t1.FromTime <= 4.0 then 4\\n\twhen t1.FromTime >= 4.0 and t1.FromTime <= 5.0 then 5\\n\twhen t1.FromTime >= 5.0 and t1.FromTime <= 6.0 then 6\\n\twhen t1.FromTime >= 6.0 and t1.FromTime <= 7.0 then 7\\n\twhen t1.FromTime >= 7.0 and t1.FromTime <= 8.0 then 8\\n\twhen t1.FromTime >= 8.0 and t1.FromTime <= 9.0 then 9\\n\twhen t1.FromTime >= 9.0 and t1.FromTime <= 10.0 then 10\\n\twhen t1.FromTime >= 10.0 and t1.FromTime <= 11.0 then 11\\n\twhen t1.FromTime >= 11.0 and t1.FromTime <= 12.0 then 12\\n\twhen t1.FromTime >= 12.0 and t1.FromTime <= 13.0 then 13\\n\twhen t1.FromTime >= 13.0 and t1.FromTime <= 14.0 then 14\\n\twhen t1.FromTime >= 14.0 and t1.FromTime <= 15.0 then 15\\n\twhen t1.FromTime >= 15.0 and t1.FromTime <= 16.0 then 16\\n\twhen t1.FromTime >= 16.0 and t1.FromTime <= 17.0 then 17\\n\twhen t1.FromTime >= 17.0 and t1.FromTime <= 18.0 then 18\\n\twhen t1.FromTime >= 18.0 and t1.FromTime <= 19.0 then 19\\n\twhen t1.FromTime >= 19.0 and t1.FromTime <= 20.0 then 20\\n\twhen t1.FromTime >= 20.0 and t1.FromTime <= 21.0 then 21\\n\twhen t1.FromTime >= 21.0 and t1.FromTime <= 22.0 then 22\\n\twhen t1.FromTime >= 22.0 and t1.FromTime <= 23.0 then 23\\n\twhen t1.FromTime >= 23.0 and t1.FromTime <= 24.0 then 24\\n\telse 0 \\n\tEnd as ReservationHourID,\\n\tCase \\n\twhen t1.Pax >= 1 and t1.Pax <= 2 then 1\\n\twhen t1.Pax >= 3 and t1.Pax <= 4 then 2\\n\twhen t1.Pax >= 5 and t1.Pax <= 9 then 3\\n\twhen t1.Pax >= 10 then 4\\n\telse 0 \\n\tEnd as GroupSizeId,\\n\tIsNull(t16.DimBookinGsourceId,0) as DimBookinGsourceId\t\\n\tfrom DimBOTBillNo T0\\n\tInner Join DimReservation T1 on T0.ReservationId = T1.ReservationId\\n\tleft outer join DimPosMst t2 on t1.RestaurantId = t2.RestaurantID\\n\tleft outer join Dimfloor t3 on t1.FloorId = t3.FloorID\\n\tleft outer join DimGuest t4 on t1.GuestId = t4.CustomerCode\\n\tleft outer join DimBooker t5 on t1.BookerId = t5.BookerID\\n\tleft outer join DimMealStructure t6 on t1.MealStructureId = t6.MealStructureID\\n\tleft outer join dimevent t8 on t1.OccassionId = t8.eventId\\n\tleft outer join DimFlag t9 on t1.FlagId = t9.FlagID\\n\tleft outer join DimStatus t10 on t1.Status = t10.StatusID\\n\tleft outer join DimReason t11 on t1.Reason = t11.ReasonID\\n\tleft outer join DimResvCancel t12 on t1.IsCancelled = t12.ResvCancelCode\\n\tleft outer join DimWalkIns t13 on t1.IsWalkin = t13.WalkInCode\\n\tleft outer join DimLastVisited t14 on t1.guestid = t14.guestid\\n\tleft outer join DimGuestRating t15 on t4.RatingID = t15.RatingCode\\n\tLeft Outer Join DimBookingSource t16 on T1.BookingSourceId = T16.BookingSourceId\\n\tLeft Outer Join DimPaymentModeMst T17 on T0.PayMode = T17.PaymentModeCode\\n\tleft outer join DimDateTime T18 on T0.BillDateTime = T18.CDate\\n\tleft outer join DimDateTime T19 on T1.ReservedDate = T19.CDate',\n\tformat: 'query') ~> dsfactbotbills\ndsfactbotbills sink(input(\n\t\tFactBOTBillNoID as integer,\n\t\tDimBOTBillNoID as integer,\n\t\tDimReservationId as integer,\n\t\tPOSId as integer,\n\t\tDimFloorId as integer,\n\t\tGuestId as integer,\n\t\tDimBookerId as integer,\n\t\tDimMealStructureId as integer,\n\t\tPax as integer,\n\t\tVisitsCount as integer,\n\t\tOccassionId as integer,\n\t\tDimFlagId as integer,\n\t\tActualPax as integer,\n\t\tDimStatusID as integer,\n\t\tResvCancelID as integer,\n\t\tDimReasonID as integer,\n\t\tWalkinID as integer,\n\t\tLastVisitedID as integer,\n\t\tVisitStatusID as integer,\n\t\tGuestRatingID as integer,\n\t\tReservationHourID as integer,\n\t\tDaysNotVisitedID as integer,\n\t\tTableID as integer,\n\t\tNoShowId as integer,\n\t\tDimBookingSourceID as integer,\n\t\tReservedDateId as integer,\n\t\tBillDateTimeId as integer,\n\t\tBillAmount as decimal(38,8),\n\t\tPaymentModeID as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tmapColumn(\n\t\tDimBOTBillNoID,\n\t\tDimReservationId,\n\t\tPOSId = POSID,\n\t\tDimFloorId = DimFloorID,\n\t\tGuestId = GuestID,\n\t\tDimBookerId = DimBookerID,\n\t\tDimMealStructureId,\n\t\tPax,\n\t\tVisitsCount,\n\t\tOccassionId = DimEventID,\n\t\tDimFlagId = DimFlagID,\n\t\tActualPax,\n\t\tDimStatusID,\n\t\tResvCancelID,\n\t\tDimReasonID,\n\t\tWalkinID = WalkInID,\n\t\tLastVisitedID = LastVisitedId,\n\t\tVisitStatusID,\n\t\tGuestRatingID,\n\t\tReservationHourID,\n\t\tDaysNotVisitedID,\n\t\tDimBookingSourceID = DimBookinGsourceId,\n\t\tReservedDateId,\n\t\tBillDateTimeId,\n\t\tBillAmount,\n\t\tPaymentModeID\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> FactBOTBills"
		}
	}
}