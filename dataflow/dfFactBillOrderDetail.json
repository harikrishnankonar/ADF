{
	"name": "dfFactBillOrderDetail",
	"properties": {
		"folder": {
			"name": "POS Transaction"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "dsdwsourcedb",
						"type": "DatasetReference"
					},
					"name": "dsFactBillOrderDetail"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "FactBillOrderDetail_Dest",
						"type": "DatasetReference"
					},
					"name": "FactBillOrderDetail"
				}
			],
			"transformations": [],
			"script": "source(output(\n\t\tBillOrderDetailID as integer,\n\t\tPOSID as integer,\n\t\tPropertyID as integer,\n\t\tRegionID as integer,\n\t\tBrandID as integer,\n\t\tCountryID as integer,\n\t\tDateTimeID as integer,\n\t\tMenuItemID as integer,\n\t\tIncomeHeadID as integer,\n\t\tQuantity as decimal(38,8),\n\t\tCostCenterID as integer,\n\t\tMenuHeadID as integer,\n\t\tMenuGroupID as integer,\n\t\tMenuSubGroupID as integer,\n\t\tFreeQuantity as decimal(38,8),\n\t\tRate as decimal(38,8),\n\t\tOriginalRate as decimal(38,8),\n\t\tBackwardRate as decimal(38,8),\n\t\tCost as decimal(38,8),\n\t\tDiscount as decimal(38,8),\n\t\tModifierRate as decimal(38,8),\n\t\tCalcDiscount as decimal(38,8),\n\t\tNetAmount as decimal(38,8),\n\t\tItemTotalTax as decimal(38,10),\n\t\tVoidReasonID as integer,\n\t\tBillOrderHeadID as integer,\n\t\tComplimentID as integer,\n\t\tBillNo as string,\n\t\tBillAmount as decimal(38,8),\n\t\tPax as integer,\n\t\tTableID as integer,\n\t\tKOTTypeID as integer,\n\t\tEmployeeID as integer,\n\t\tTotalTax as decimal(38,8),\n\t\tTotalDiscount as decimal(38,8),\n\t\tDiscountAfterPromotion as decimal(38,8),\n\t\tRoundOffAmount as decimal(38,8),\n\t\tComplimentory as decimal(38,8),\n\t\tTotalTipAmount as decimal(38,8),\n\t\tGroupSizeID as integer,\n\t\tCashID as integer,\n\t\tCreditCardID as integer,\n\t\tSettleDateTimeId as integer,\n\t\tReservationID as integer,\n\t\tDimFloorID as integer,\n\t\tGuestID as integer,\n\t\tDimBookerID as integer,\n\t\tDimMealStructureId as integer,\n\t\tReservationDateID as integer,\n\t\tVisitsCount as integer,\n\t\tDimEventID as integer,\n\t\tDimFlagID as integer,\n\t\tActualPax as integer,\n\t\tDimStatusID as integer,\n\t\tResvCancelID as integer,\n\t\tDimReasonID as integer,\n\t\tWalkInID as integer,\n\t\tLastVisitedId as integer,\n\t\tDaysNotVisitedID as integer,\n\t\tVisitStatusID as integer,\n\t\tGuestRatingID as integer,\n\t\tReservationHourID as integer,\n\t\tMealID as integer,\n\t\tPosRegionID as integer,\n\t\tBillID as integer,\n\t\tUserID as integer,\n\t\tDimStyleofOperationID as integer,\n\t\tDimDiscCardID as integer,\n\t\tWaiterId as integer,\n\t\tBillMade_POSShiftId as integer,\n\t\tBillSettled_POSShiftId as integer,\n\t\tOverCounterSalesID as integer,\n\t\tSourceApplicationId as integer,\n\t\tTDHID as integer,\n\t\tCourseMasterId as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'Select \tisnull(t1.BillOrderDetailID,0) BillOrderDetailID,\\nisnull(t2.POSID,0) POSID,\\nisnull(t3.PropertyID,0) PropertyID,\\nisnull(t4.RegionID,0) RegionID,\\nisnull(t5.BrandID,0) BrandID,\\nisnull(t6.CountryID,0) CountryID,\\nisnull(t7.DateTimeID,0) DateTimeID,\\nisnull(t8.MenuItemID,0) MenuItemID,\\nisnull(t9.IncomeHeadID,0) IncomeHeadID,\\nisnull(t1.Quantity,0) Quantity,\\nisnull(t10.CostCenterID,0) CostCenterID,\\nisnull(t11.MenuHeadID,0) MenuHeadID,\\nisnull(t12.MenuGroupID,0) MenuGroupID,\\nisnull(t13.MenuSubGroupID,0) MenuSubGroupID,\\nisnull(t1.FreeQuantity,0) FreeQuantity,\\nisnull(t1.Rate,0) Rate,\\nisnull(t1.OriginalRate,0) OriginalRate,\\nisnull(t1.BackwardRate,0) BackwardRate,\\nisnull(t1.Cost,0) Cost,\\nisnull(t1.Discount,0) Discount,\\nisnull(t1.ModifierRate,0) ModifierRate,\\nisnull(t1.CalcDiscount,0) CalcDiscount,\\nround(isnull(t1.NetAmount,0),2,0) NetAmount,\\nisnull(t1.ItemTotalTax,0) ItemTotalTax,\\nisnull(t14.VoidReasonID,0) VoidReasonID,\\nisnull(t17.BillOrderHeadID,0) BillOrderHeadID,\\nCase When isnull(t1.PayCompliment,0) = 1 then 1 else 0 end as ComplimentID,\\nisnull(t17.BillNo,0) BillNo,\\nisnull(t17.BillAmount,0) BillAmount,\\nisnull(t17.Pax,0) Pax,\\nisnull(t20.TableID,0) TableID,\\nisnull(t21.KOTTypeID,0) KOTTypeID,\\nisnull(t22.EmployeeID,0) EmployeeID,\\nisnull(t17.TotalTax,0) TotalTax,\\nisnull(t17.TotalDiscount,0) TotalDiscount,\\nisnull(t1.DiscountAfterPromotion,0) DiscountAfterPromotion,\\nisnull(t17.RoundOffAmount,0) RoundOffAmount,\\nisnull(t17.Complimentory,0) Complimentory,\\nisnull(t17.TotalTipAmount,0) TotalTipAmount,\\nCase \\nwhen t17.Pax >= 1 and t17.Pax <= 2 then 1\\nwhen t17.Pax >= 3 and t17.Pax <= 4 then 2\\nwhen t17.Pax >= 5 and t17.Pax <= 9 then 3\\nwhen t17.Pax >= 10 and t17.Pax <= 100 then 4\\nelse 0 \\nEnd as GroupSizeID,\\nISNULL(t18.CashID,0) CashID,\\nisnull(t19.CreditCardID,0) CreditCardID,\\nisnull(t23.DateTimeId,0) SettleDateTimeId,\\nisnull(t24.ReservationID,0) ReservationID,\\nisnull(t25.DimFloorId,0) DimFloorID,\\nisnull(t26.GuestID,0) GuestID,\\nisnull(t27.DimBookerID,0) DimBookerID,\\nisnull(t28.DimMealStructureId,0) DimMealStructureId,\\nisnull(t29.DateTimeID,0) ReservationDateID,\\nCase when t24.ReservationId > 0 then 1 else 0 End VisitsCount,\\nisnull(t30.DimEventID,0) DimEventID,\\nisnull(t31.DimFlagId,0) DimFlagID,\\nisnull(t24.ActualPax,0) ActualPax,\\nisnull(t32.DimStatusID,0) DimStatusID,\\nisnull(t34.ResvCancelID,0) ResvCancelID,\\nisnull(t33.DimReasonID,0) DimReasonID,\\nisnull(t35.WalkInID,0) WalkInID,\\nisnull(t36.LastVisitedId,0) LastVisitedId,\\nCase \\nwhen t36.DaysNotVisited >= 31 and t36.DaysNotVisited <= 60 then 1\\nwhen t36.DaysNotVisited >= 61 and t36.DaysNotVisited <= 90 then 2\\nwhen t36.DaysNotVisited >= 91 and t36.DaysNotVisited <= 120 then 3\\nwhen t36.DaysNotVisited >= 121 and t36.DaysNotVisited <= 150 then 4\\nwhen t36.DaysNotVisited >= 151 and t36.DaysNotVisited <= 180 then 5\\nwhen t36.DaysNotVisited >= 181 and t36.DaysNotVisited <= 270 then 6\\nwhen t36.DaysNotVisited >= 271 and t36.DaysNotVisited <= 365 then 7\\nwhen t36.DaysNotVisited >= 366 then 8\\nelse 0 \\nEnd as DaysNotVisitedID,\\nCase \\nwhen t36.VisitCount >= 1 and t36.VisitCount <= 1 then 1\\nwhen t36.VisitCount >= 2 and t36.VisitCount <= 9 then 2\\nwhen t36.VisitCount >= 10 and t36.VisitCount <= 50 then 3\\nwhen t36.VisitCount >= 51 then 4\\nwhen t36.VisitCount is null then 0\\nelse 0 \\nEnd as VisitStatusID,\\nisnull(t37.GuestRatingID,0) GuestRatingID,\\nDatePart(HH,isnull(t17.SettleTime,\\'0:00\\'))+1 ReservationHourID,\\nIsNull(t17.BillSettledShift,0) as  MealID,\\nisnull(t39.PosRegionID,0) PosRegionID,\\nISNULL(t40.DimBillNoID,0) BillID,\\nISNULL(t41.UserID,0) UserID,\\nISNULL(t42.DimStyleofOperationID,0) DimStyleofOperationID ,\\nIsNull(t43.DimDiscCardID,0) As DimDiscCardID,\\nIsNull(T44.WaiterId,0) AS WaiterId,\\nISNULL(T17.BillMadeShift,0) as BillMade_POSShiftId,\\nISNULL(T17.BillSettledShift,0) as BillSettled_POSShiftId ,\\nisnull(t47.OverCounterSalesId,0)  OverCounterSalesID,\\nIsNull(T48.SourceApplicationId,0) as SourceApplicationId,\\nIsNull(T49.TDHID,0) as TDHID,\\nIsNull(T50.CourseMasterId,0) as CourseMasterId\\nFrom DimBillOrderDetail t1 with(nolock)\\nleft outer join DimPosMst t2 with(nolock) on t1.POSCode = t2.POSCode \\nleft outer join DimPropertyMst t3 with(nolock) on t1.PropertyCode = t3.PropertyCode \\nleft outer join DimRegionMst t4 with(nolock) on t1.RegionCode = t4.RegionCode \\nleft outer join DimBrandMst t5 with(nolock) on t1.BrandCode = t5.BrandCode \\nleft outer join DimCountryMst t6 with(nolock) on t1.CountryCode = t6.CountryCode \\nleft outer join DimDateTime t7 with(nolock) on t1.BillDateTime = t7.CDate\\nleft outer join DimMenuItemMst t8 with(nolock) on t1.MenuItemCode = t8.MenuItemCode \\nleft outer join DimIncomeHeadMst t9 with(nolock) on t1.IncomeHeadCode = t9.IncomeHeadCode \\nleft outer join DimCostCenterMst t10 with(nolock) on t1.CostCenterCode = t10.CostCenterCode \\nleft outer join DimMenuHeadMst t11 with(nolock) on t1.MenuHeadCode = t11.MenuHeadCode and t1.poscode = t11.poscode \\nleft outer join DimMenuGroupMst t12 with(nolock) on t1.MenuGroupCode = t12.MenuGroupCode \\nleft outer join DimMenuSubGroupMst t13 with(nolock) on t1.MenuSubGroupCode = t13.MenuSubGroupCode \\nleft outer join DimVoidReasonMst t14 with(nolock) on t1.VoidReasonCode = t14.VoidReasonCode \\nleft outer join DimBillOrderHead t17 with(nolock) on t1.POSCode = t17.POSCode and t1.BillNo = t17.BillNo \\nleft outer join DimCash t18 with(nolock) on t17.paycash = t18.CashCode\\nleft outer join DimCreditCard t19 with(nolock) on t17.payCreditCard = t19.CreditCardCode\\nleft outer join DimTableMst t20 with(nolock) on t17.TableRoomCode = t20.TableCode and t17.PosCode = t20.PosCode \\nleft outer join DimKOTTypes t21  with(nolock) on t17.KOTType =  t21.KOTTypeCode \\nleft outer join DimEmployeeMst t22 with(nolock) on t17.EmployeeCode = t22.EmployeeCode \\nleft outer join DimDateTime t23 with(nolock) on t17.SettleDate = t23.CDate\\nleft outer join DimReservation t24 with(nolock) on t1.ReservationNo = t24.ReservationId\\nleft outer join Dimfloor t25 with(nolock) on t24.FloorId = t25.FloorID\\nleft outer join DimGuest t26 with(nolock) on t24.GuestId = t26.CustomerCode\\nleft outer join DimBooker t27 with(nolock) on t24.BookerId = t27.BookerID \\nleft outer join DimMealStructure t28 with(nolock) on t24.MealStructureId = t28.MealStructureID\\nleft outer join DimDateTime t29 with(nolock) on t24.reserveddate = t29.Cdate\\nleft outer join dimevent t30 with(nolock) on t24.OccassionId = t30.eventId\\nleft outer join DimFlag t31 with(nolock) on t24.FlagId = t31.FlagID\\nleft outer join DimStatus t32 with(nolock) on t24.Status = t32.StatusID\\nleft outer join DimReason t33 with(nolock) on t24.Reason = t33.ReasonID\\nleft outer join DimResvCancel t34 with(nolock) on t24.IsCancelled = t34.ResvCancelCode\\nleft outer join DimWalkIns t35 with(nolock) on t24.IsWalkin = t35.WalkInCode\\nleft outer join DimLastVisited t36 with(nolock) on t24.guestid = t36.guestid\\nleft outer join DimGuestRating t37 with(nolock) on t26.RatingID = t37.RatingCode\\nleft outer join DimPosRegion t39 with(nolock) on t1.ClientId = t39.PosRegionCode\\nleft outer join DimBillNo t40 with(nolock) on t1.POSCode = t40.PosCode and t1.BillDateTime = t40.BillDate and t1.BillNo = t40.BillNo\\nleft outer join DimUser t41 with(nolock) on t17.BillMadeBy = t41.UserShortName \\nleft outer join DimStyleOfOperation t42 with(nolock) on t17.OrderFrom = t42.OrderFrom\\nleft outer join DimDiscCardMst t43 with(nolock) on t17.DiscCardCode = t43.DiscCardCode and t17.DiscCardDetailsCode = t43.DiscCardDetailsCode\\nLeft Outer Join DimWaiterMst T44 on T17.WaiterCode = T44.EmployeeCode and T17.PosCode = T44.PosCode\\nleft outer join OverCounterSalesMaster t47 with(nolock) on t17.OverCounter = t47.OverCounterSalesCode\\nleft outer join dbo.SourceApplication t48 with(nolock) on t17.UpdFrm = t48.SourceApplicationCode\\nleft outer join DimTDHMst t49 with(noLock) on T1.TDHCode = T49.TDHCode\\nleft outer join CourseMaster T50 with(NoLock) on T50.CourseCode = T1.CourseCode',\n\tformat: 'query') ~> dsFactBillOrderDetail\ndsFactBillOrderDetail sink(input(\n\t\tFactBillOrderDetailID as integer,\n\t\tBillOrderDetailID as integer,\n\t\tPOSID as integer,\n\t\tPropertyID as integer,\n\t\tRegionID as integer,\n\t\tBrandID as integer,\n\t\tCountryID as integer,\n\t\tBillDateID as integer,\n\t\tMenuItemID as integer,\n\t\tTDHID as integer,\n\t\tIncomeHeadID as integer,\n\t\tQuantity as decimal(38,8),\n\t\tCostCenterID as integer,\n\t\tMenuHeadID as integer,\n\t\tMenuGroupID as integer,\n\t\tMenuSubGroupID as integer,\n\t\tCourseID as integer,\n\t\tFreeQuantity as decimal(38,8),\n\t\tRate as decimal(38,8),\n\t\tOriginalRate as decimal(38,8),\n\t\tBackwardRate as decimal(38,8),\n\t\tCost as decimal(38,8),\n\t\tDiscount as decimal(38,8),\n\t\tModifierRate as decimal(38,8),\n\t\tCalcDiscount as decimal(38,8),\n\t\tNetAmount as decimal(38,8),\n\t\tItemTotalTax as decimal(38,10),\n\t\tVoidReasonID as integer,\n\t\tBillOrderHeadId as integer,\n\t\tComplimentID as integer,\n\t\tBillNo as string,\n\t\tBillAmount as decimal(38,8),\n\t\tPax as integer,\n\t\tTableId as integer,\n\t\tKotTypeId as integer,\n\t\tEmployeeId as integer,\n\t\tTotalTax as decimal(38,8),\n\t\tTotalDiscount as decimal(38,8),\n\t\tTotalRoundOff as decimal(38,8),\n\t\tComplimentory as decimal(38,8),\n\t\tTotalTipAmount as decimal(38,8),\n\t\tGroupSizeId as integer,\n\t\tCashID as integer,\n\t\tCreditCardID as integer,\n\t\tSettleDateTimeID as integer,\n\t\tReservationID as integer,\n\t\tDimFloorId as integer,\n\t\tGuestID as integer,\n\t\tDimBookerID as integer,\n\t\tDimMealStructureId as integer,\n\t\tReservationDateID as integer,\n\t\tVisitsCount as integer,\n\t\tDimEventID as integer,\n\t\tDimFlagID as integer,\n\t\tActualPax as integer,\n\t\tDimStatusID as integer,\n\t\tResvCancelID as integer,\n\t\tDimReasonID as integer,\n\t\tWalkInID as integer,\n\t\tLastVisitedId as integer,\n\t\tDaysNotVisitedID as integer,\n\t\tVisitStatusID as integer,\n\t\tGuestRatingID as integer,\n\t\tReservationHourID as integer,\n\t\tBillID as integer,\n\t\tDiscountAfterPromotion as decimal(38,8),\n\t\tMealId as integer,\n\t\tPosRegionID as integer,\n\t\tUserId as integer,\n\t\tDimStyleofOperationID as integer,\n\t\tDimDiscCardID as integer,\n\t\tWaiterId as integer,\n\t\tBillMade_POSShiftId as integer,\n\t\tBillSettled_POSShiftId as integer,\n\t\tOverCounterSalesID as integer,\n\t\tSourceApplicationId as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tmapColumn(\n\t\tBillOrderDetailID,\n\t\tPOSID,\n\t\tPropertyID,\n\t\tRegionID,\n\t\tBrandID,\n\t\tCountryID,\n\t\tBillDateID = DateTimeID,\n\t\tMenuItemID,\n\t\tTDHID,\n\t\tIncomeHeadID,\n\t\tQuantity,\n\t\tCostCenterID,\n\t\tMenuHeadID,\n\t\tMenuGroupID,\n\t\tMenuSubGroupID,\n\t\tCourseID = CourseMasterId,\n\t\tFreeQuantity,\n\t\tRate,\n\t\tOriginalRate,\n\t\tBackwardRate,\n\t\tCost,\n\t\tDiscount,\n\t\tModifierRate,\n\t\tCalcDiscount,\n\t\tNetAmount,\n\t\tItemTotalTax,\n\t\tVoidReasonID,\n\t\tBillOrderHeadId = BillOrderHeadID,\n\t\tComplimentID,\n\t\tBillNo,\n\t\tBillAmount,\n\t\tPax,\n\t\tTableId = TableID,\n\t\tKotTypeId = KOTTypeID,\n\t\tEmployeeId = EmployeeID,\n\t\tTotalTax,\n\t\tTotalDiscount,\n\t\tTotalRoundOff = RoundOffAmount,\n\t\tComplimentory,\n\t\tTotalTipAmount,\n\t\tGroupSizeId = GroupSizeID,\n\t\tCashID,\n\t\tCreditCardID,\n\t\tSettleDateTimeID = SettleDateTimeId,\n\t\tReservationID,\n\t\tDimFloorId = DimFloorID,\n\t\tGuestID,\n\t\tDimBookerID,\n\t\tDimMealStructureId,\n\t\tReservationDateID,\n\t\tVisitsCount,\n\t\tDimEventID,\n\t\tDimFlagID,\n\t\tActualPax,\n\t\tDimStatusID,\n\t\tResvCancelID,\n\t\tDimReasonID,\n\t\tWalkInID,\n\t\tLastVisitedId,\n\t\tDaysNotVisitedID,\n\t\tVisitStatusID,\n\t\tGuestRatingID,\n\t\tReservationHourID,\n\t\tBillID,\n\t\tDiscountAfterPromotion,\n\t\tMealId = MealID,\n\t\tPosRegionID,\n\t\tUserId = UserID,\n\t\tDimStyleofOperationID,\n\t\tDimDiscCardID,\n\t\tWaiterId,\n\t\tBillMade_POSShiftId,\n\t\tBillSettled_POSShiftId,\n\t\tOverCounterSalesID,\n\t\tSourceApplicationId\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> FactBillOrderDetail"
		}
	}
}