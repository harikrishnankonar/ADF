{
	"name": "dfFactBillOrderVoidDetail",
	"properties": {
		"folder": {
			"name": "POS Transaction"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "dsdwsourcedb",
						"type": "DatasetReference"
					},
					"name": "dfFactBillOrderVoidDetail"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "FactBillOrderVoidDetail",
						"type": "DatasetReference"
					},
					"name": "FactBillOrderVoidDetail"
				}
			],
			"transformations": [],
			"script": "source(output(\n\t\tBillOrderVoidDetailID as integer,\n\t\tBillOrderVoidHeadID as integer,\n\t\tPOSID as integer,\n\t\tPropertyID as integer,\n\t\tRegionID as integer,\n\t\tBrandID as integer,\n\t\tCountryID as integer,\n\t\tBillDateID as integer,\n\t\tMenuItemID as integer,\n\t\tIncomeHeadID as integer,\n\t\tQuantity as decimal(38,8),\n\t\tCostCenterID as integer,\n\t\tMenuHeadID as integer,\n\t\tMenuGroupID as integer,\n\t\tMenuSubGroupID as integer,\n\t\tFreeQuantity as decimal(38,8),\n\t\tRate as decimal(38,8),\n\t\tOriginalRate as decimal(38,8),\n\t\tBackwardRate as decimal(38,8),\n\t\tCost as decimal(38,8),\n\t\tDiscount as decimal(38,8),\n\t\tModifierRate as decimal(38,8),\n\t\tCalcDiscount as decimal(38,8),\n\t\tNetAmount as decimal(38,8),\n\t\tItemTotalTax as decimal(38,10),\n\t\tVoidReasonID as integer,\n\t\tComplimentID as integer,\n\t\tBillNo as string,\n\t\tBillAmount as decimal(38,8),\n\t\tPax as integer,\n\t\tTableID as integer,\n\t\tKOTTypeID as integer,\n\t\tEmployeeID as integer,\n\t\tTotalTax as decimal(38,8),\n\t\tTotalDiscount as decimal(38,8),\n\t\tDiscountAfterPromotion as decimal(38,8),\n\t\tRoundOffAmount as decimal(38,8),\n\t\tComplimentory as decimal(38,8),\n\t\tTotalTipAmount as decimal(38,8),\n\t\tGroupSizeID as integer,\n\t\tCashID as integer,\n\t\tCreditCardID as integer,\n\t\tSettleDateTimeId as integer,\n\t\tBillID as integer,\n\t\tReservationID as integer,\n\t\tDimFloorID as integer,\n\t\tGuestID as integer,\n\t\tDimBookerID as integer,\n\t\tDimMealStructureId as integer,\n\t\tReservationDateID as integer,\n\t\tVisitsCount as integer,\n\t\tDimEventID as integer,\n\t\tDimFlagID as integer,\n\t\tActualPax as integer,\n\t\tDimStatusID as integer,\n\t\tResvCancelID as integer,\n\t\tDimReasonID as integer,\n\t\tWalkInID as integer,\n\t\tLastVisitedId as integer,\n\t\tDaysNotVisitedID as integer,\n\t\tVisitStatusID as integer,\n\t\tGuestRatingID as integer,\n\t\tReservationHourID as integer,\n\t\tMealID as integer,\n\t\tPosRegionID as integer,\n\t\tKioskID as integer,\n\t\tUserID as integer,\n\t\tVoidUserID as integer,\n\t\tDimStyleofOperationID as integer,\n\t\tDimDiscCardID as integer,\n\t\tBillVoidDateId as integer,\n\t\tWaiterId as integer,\n\t\tBillKOTTypeId as integer,\n\t\tBillMade_POSShiftId as integer,\n\t\tVoidBillKotID as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'Select isnull(t1.BillOrderVoidDetailID,0) BillOrderVoidDetailID,\\n\tisnull(t17.BillOrderVoidHeadID,0) BillOrderVoidHeadID,\\n\tisnull(t2.POSID,0) POSID,\\n\tisnull(t3.PropertyID,0) PropertyID,\\n\tisnull(t4.RegionID,0) RegionID,\\n\tisnull(t5.BrandID,0) BrandID,\\n\tisnull(t6.CountryID,0) CountryID,\\n\tisnull(t7.DateTimeID,0) BillDateID,\\n\tisnull(t8.MenuItemID,0) MenuItemID,\\n\tisnull(t9.IncomeHeadID,0) IncomeHeadID,\\n\tisnull(t1.Quantity,0) Quantity,\\n\tisnull(t10.CostCenterID,0) CostCenterID,\\n\tisnull(t11.MenuHeadID,0) MenuHeadID,\\n\tisnull(t12.MenuGroupID,0) MenuGroupID,\\n\tisnull(t13.MenuSubGroupID,0) MenuSubGroupID,\\n\tisnull(t1.FreeQuantity,0) FreeQuantity,\\n\tisnull(t1.Rate,0) Rate,\\n\tisnull(t1.OriginalRate,0) OriginalRate,\\n\tisnull(t1.BackwardRate,0) BackwardRate,\\n\tisnull(t1.Cost,0) Cost,\\n\tisnull(t1.Discount,0) Discount,\\n\tisnull(t1.ModifierRate,0) ModifierRate,\\n\tisnull(t1.CalcDiscount,0) CalcDiscount,\\n\tisnull(t1.NetAmount,0) NetAmount,\\n\tisnull(t1.ItemTotalTax,0) ItemTotalTax,\\n\tisnull(t14.VoidReasonID,0) VoidReasonID,\\n    Case When isnull(t1.PayCompliment,0) = 1 then 1 else 0 end as ComplimentID,\\n\tisnull(t17.BillNo,0) BillNo,\\n\tisnull(t17.BillAmount,0) BillAmount,\\n\tisnull(t17.Pax,0) Pax,\\n\tisnull(t20.TableID,0) TableID,\\n\tisnull(t21.KOTTypeID,0) KOTTypeID,\\n\tisnull(t22.EmployeeID,0) EmployeeID,\\n\tisnull(t17.TotalTax,0) TotalTax,\\n\tisnull(t17.TotalDiscount,0) TotalDiscount,\\n    isnull(t1.DiscountAfterPromotion,0) DiscountAfterPromotion,\\n\tisnull(t17.RoundOffAmount,0) RoundOffAmount,\\n\tisnull(t17.Complimentory,0) Complimentory,\\n\tisnull(t17.TotalTipAmount,0) TotalTipAmount,\\n\tCase \\n\t\twhen t17.Pax >= 1 and t17.Pax <= 2 then 1\\n\t\twhen t17.Pax >= 3 and t17.Pax <= 4 then 2\\n\t\twhen t17.Pax >= 5 and t17.Pax <= 9 then 3\\n\t\twhen t17.Pax >= 10 and t17.Pax <= 100 then 4\\n\t\telse 0 \\n\tEnd as GroupSizeID,\\n\tISNULL(t18.CashID,0) CashID,\\n\tisnull(t19.CreditCardID,0) CreditCardID,\\n\tisnull(t23.DateTimeId,0) SettleDateTimeId,\\n\tisnull(t38.DimBillNoID,0) as BillID,\\n\tisnull(t24.ReservationID,0) ReservationID,\\n\tisnull(t25.DimFloorId,0) DimFloorID,\\n\tisnull(t26.GuestID,0) GuestID,\\n\tisnull(t27.DimBookerID,0) DimBookerID,\\n\tisnull(t28.DimMealStructureId,0) DimMealStructureId,\\n\tisnull(t29.DateTimeID,0) ReservationDateID,\\n\tCase when t24.ReservationId > 0 then 1 else 0 End VisitsCount,\\n\tisnull(t30.DimEventID,0) DimEventID,\\n\tisnull(t31.DimFlagId,0) DimFlagID,\\n\tisnull(t24.ActualPax,0) ActualPax,\\n\tisnull(t32.DimStatusID,0) DimStatusID,\\n\tisnull(t34.ResvCancelID,0) ResvCancelID,\\n\tisnull(t33.DimReasonID,0) DimReasonID,\\n\tisnull(t35.WalkInID,0) WalkInID,\\n    isnull(t36.LastVisitedId,0) LastVisitedId,\\n\tCase \\n\twhen t36.DaysNotVisited >= 31 and t36.DaysNotVisited <= 60 then 1\\n\twhen t36.DaysNotVisited >= 61 and t36.DaysNotVisited <= 90 then 2\\n\twhen t36.DaysNotVisited >= 91 and t36.DaysNotVisited <= 120 then 3\\n\twhen t36.DaysNotVisited >= 121 and t36.DaysNotVisited <= 150 then 4\\n\twhen t36.DaysNotVisited >= 151 and t36.DaysNotVisited <= 180 then 5\\n\twhen t36.DaysNotVisited >= 181 and t36.DaysNotVisited <= 270 then 6\\n\twhen t36.DaysNotVisited >= 271 and t36.DaysNotVisited <= 365 then 7\\n\twhen t36.DaysNotVisited >= 366 then 8\\n\telse 0 \\n\tEnd as DaysNotVisitedID,\\n\tCase \\n\twhen t36.VisitCount >= 1 and t36.VisitCount <= 1 then 1\\n\twhen t36.VisitCount >= 2 and t36.VisitCount <= 9 then 2\\n\twhen t36.VisitCount >= 10 and t36.VisitCount <= 50 then 3\\n\twhen t36.VisitCount >= 51 then 4\\n\twhen t36.VisitCount is null then 0\\n\telse 0 \\n\tEnd as VisitStatusID,\\n\tisnull(t37.GuestRatingID,0) GuestRatingID,\\n\tDatePart(HH,isnull(t17.SettleTime,\\'0:00\\'))+1 ReservationHourID,\\n\tIsNull(t17.ShiftCode,0) as  MealID,\\n\tisnull(t39.PosRegionID,0) PosRegionID,\\n\tisnull(t41.KioskID,0) KioskID,\\n\tisnull(t42.UserID,0) UserID,\\n\tisnull(t43.EmployeeId,0) VoidUserID,\\n\tISNULL(t44.DimStyleofOperationID,0) DimStyleofOperationID ,\\n\tIsNull(t45.DimDiscCardID,0) As DimDiscCardID,\\n\tIsNull(t46.DateTimeID,0) As BillVoidDateId\\n\t, IsNull(T47.WaiterId,0) AS WaiterId\\n\t,IsNull(T48.BillKOTTypeId,0) AS BillKOTTypeId\\n,ISNULL(T17.BillMadeShift,0) as BillMade_POSShiftId\\n, IsNull(T50.VoidBillKotID,0) VoidBillKotID\\nFrom DimBillOrderVoidDetail t1 with(nolock)\\nleft outer join DimPosMst t2 with(nolock) on t1.POSCode = t2.POSCode\\nleft outer join DimPropertyMst t3 with(nolock) on t1.PropertyCode = t3.PropertyCode\\nleft outer join DimRegionMst t4 with(nolock) on t1.RegionCode = t4.RegionCode\\nleft outer join DimBrandMst t5 with(nolock) on t1.BrandCode = t5.BrandCode\\nleft outer join DimCountryMst t6 with(nolock) on t1.CountryCode = t6.CountryCode\\nleft outer join DimDateTime t7 with(nolock) on t1.BillDateTime = t7.CDate\\nleft outer join DimMenuItemMst t8 with(nolock) on t1.MenuItemCode = t8.MenuItemCode\\nleft outer join DimIncomeHeadMst t9 with(nolock) on t1.IncomeHeadCode = t9.IncomeHeadCode\\nleft outer join DimCostCenterMst t10 with(nolock) on t1.CostCenterCode = t10.CostCenterCode \\nleft outer join DimMenuHeadMst t11 with(nolock) on t1.MenuHeadCode = t11.MenuHeadCode and t1.poscode = t11.poscode\\nleft outer join DimMenuGroupMst t12 with(nolock) on t1.MenuGroupCode = t12.MenuGroupCode\\nleft outer join DimMenuSubGroupMst t13 with(nolock) on t1.MenuSubGroupCode = t13.MenuSubGroupCode\\nleft outer join DimVoidReasonMst t14 with(nolock) on t1.VoidReasonCode = t14.VoidReasonCode\\nleft outer join DimBillOrderVoidHead t17 with(nolock) on t1.POSCode = t17.POSCode and t1.BillNo = t17.BillNo and t1.Billorder = t17.BillOrder\\nleft outer join DimCash t18 with(nolock) on t17.paycash = t18.CashCode\\nleft outer join DimCreditCard t19 with(nolock) on t17.payCreditCard = t19.CreditCardCode\\nleft outer join DimTableMst t20 with(nolock) on t17.TableRoomCode = t20.TableCode\\nleft outer join DimKOTTypes t21  with(nolock) on t17.KOTType =  t21.KOTTypeCode\\nleft outer join DimEmployeeMst t22 with(nolock) on t17.EmployeeCode = t22.EmployeeCode\\nleft outer join DimDateTime t23 with(nolock) on t17.SettleDate = t23.CDate\\nleft outer join DimBillNo t38 with(nolock) on t1.POSCode = t38.PosCode and t1.BillNo = t38.BillNo and t1.BillDateTime = t38.BillDate \\nleft outer join DimReservation t24 with(nolock) on t1.ReservationNo = t24.ReservationId\\nleft outer join Dimfloor t25 with(nolock) on t24.FloorId = t25.FloorID\\nleft outer join DimGuest t26 with(nolock) on t24.GuestId = t26.CustomerCode\\nleft outer join DimBooker t27 with(nolock) on t24.BookerId = t27.BookerID \\nleft outer join DimMealStructure t28 with(nolock) on t24.MealStructureId = t28.MealStructureID\\nleft outer join DimDateTime t29 with(nolock) on t24.reserveddate = t29.Cdate\\nleft outer join dimevent t30 with(nolock) on t24.OccassionId = t30.eventId\\nleft outer join DimFlag t31 with(nolock) on t24.FlagId = t31.FlagID\\nleft outer join DimStatus t32 with(nolock) on t24.Status = t32.StatusID\\nleft outer join DimReason t33 with(nolock) on t24.Reason = t33.ReasonID\\nleft outer join DimResvCancel t34 with(nolock) on t24.IsCancelled = t34.ResvCancelCode\\nleft outer join DimWalkIns t35 with(nolock) on t24.IsWalkin = t35.WalkInCode\\nleft outer join DimLastVisited t36 with(nolock) on t24.guestid = t36.guestid\\nleft outer join DimGuestRating t37 with(nolock) on t26.RatingID = t37.RatingCode\\nleft outer join DimPosRegion t39 with(nolock) on t1.ClientId = t39.PosRegionCode\\nleft outer join DimKioskMst t41 with(nolock) on t1.KioskCode = t41.KioskCode\\nleft outer join DimUser t42 with(nolock) on t17.BillVoidBy = t42.UserShortName\\nleft outer join DimEmployeeMst t43 with(nolock) on t43.EmployeeCode = t42.EmployeeCode\\nleft outer join DimStyleOfOperation t44 with(nolock) on t17.OrderFrom = t44.OrderFrom\\nleft outer join DimDiscCardMst t45 with(nolock) on t17.DiscCardCode = t45.DiscCardCode and t17.DiscCardDetailsCode = t45.DiscCardDetailsCode\\nleft outer join DimDateTime t46 with(nolock) on Cast(t1.BillVoidDate as Date) = t46.CDate\\nLeft Outer Join DimWaiterMst T47 on T17.WaiterCode = T47.EmployeeCode and T17.PosCode = T47.PosCode\\nLeft Outer Join DimBillKOTType T48 on ltrim(Rtrim(T1.BillOrder)) = T48.BillKOTType\\nLeft Outer Join DimViodBillKot T50 on T17.PosCode = T50.PosCode and T17.BillNo = T50.BillNo',\n\tformat: 'query') ~> dfFactBillOrderVoidDetail\ndfFactBillOrderVoidDetail sink(input(\n\t\tFactBillOrderVoidDetailID as integer,\n\t\tBillOrderVoidDetailID as integer,\n\t\tBillOrderVoidHeadId as integer,\n\t\tPOSID as integer,\n\t\tPropertyID as integer,\n\t\tRegionID as integer,\n\t\tBrandID as integer,\n\t\tCountryID as integer,\n\t\tBillDateID as integer,\n\t\tMenuItemID as integer,\n\t\tIncomeHeadID as integer,\n\t\tQuantity as decimal(38,8),\n\t\tCostCenterID as integer,\n\t\tMenuHeadID as integer,\n\t\tMenuGroupID as integer,\n\t\tMenuSubGroupID as integer,\n\t\tFreeQuantity as decimal(38,8),\n\t\tRate as decimal(38,8),\n\t\tOriginalRate as decimal(38,8),\n\t\tBackwardRate as decimal(38,8),\n\t\tCost as decimal(38,8),\n\t\tDiscount as decimal(38,8),\n\t\tModifierRate as decimal(38,8),\n\t\tCalcDiscount as decimal(38,8),\n\t\tNetAmount as decimal(38,8),\n\t\tItemTotalTax as decimal(38,10),\n\t\tVoidReasonID as integer,\n\t\tComplimentID as integer,\n\t\tBillNo as string,\n\t\tBillAmount as decimal(38,8),\n\t\tPax as integer,\n\t\tTableId as integer,\n\t\tKotTypeId as integer,\n\t\tEmployeeId as integer,\n\t\tTotalTax as decimal(38,8),\n\t\tTotalDiscount as decimal(38,8),\n\t\tDiscountAfterPromotion as decimal(38,8),\n\t\tTotalRoundOff as decimal(38,8),\n\t\tComplimentory as decimal(38,8),\n\t\tTotalTipAmount as decimal(38,8),\n\t\tGroupSizeId as integer,\n\t\tCashID as integer,\n\t\tCreditCardID as integer,\n\t\tSettleDateTimeID as integer,\n\t\tBillID as integer,\n\t\tReservationID as integer,\n\t\tDimFloorID as integer,\n\t\tGuestID as integer,\n\t\tDimBookerID as integer,\n\t\tDimMealStructureId as integer,\n\t\tReservationDateID as integer,\n\t\tVisitsCount as integer,\n\t\tDimEventID as integer,\n\t\tDimFlagID as integer,\n\t\tActualPax as integer,\n\t\tDimStatusID as integer,\n\t\tResvCancelID as integer,\n\t\tDimReasonID as integer,\n\t\tWalkInID as integer,\n\t\tLastVisitedId as integer,\n\t\tDaysNotVisitedID as integer,\n\t\tVisitStatusID as integer,\n\t\tGuestRatingID as integer,\n\t\tReservationHourID as integer,\n\t\tMealId as integer,\n\t\tDimStyleofOperationID as integer,\n\t\tDimDiscCardID as integer,\n\t\tKioskID as integer,\n\t\tUserID as integer,\n\t\tVoidUserID as integer,\n\t\tBillVoidDateId as integer,\n\t\tWaiterId as integer,\n\t\tBillKOTTypeId as integer,\n\t\tBillMade_POSShiftId as integer,\n\t\tVoidBillKotID as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tmapColumn(\n\t\tBillOrderVoidDetailID,\n\t\tBillOrderVoidHeadId = BillOrderVoidHeadID,\n\t\tPOSID,\n\t\tPropertyID,\n\t\tRegionID,\n\t\tBrandID,\n\t\tCountryID,\n\t\tBillDateID,\n\t\tMenuItemID,\n\t\tIncomeHeadID,\n\t\tQuantity,\n\t\tCostCenterID,\n\t\tMenuHeadID,\n\t\tMenuGroupID,\n\t\tMenuSubGroupID,\n\t\tFreeQuantity,\n\t\tRate,\n\t\tOriginalRate,\n\t\tBackwardRate,\n\t\tCost,\n\t\tDiscount,\n\t\tModifierRate,\n\t\tCalcDiscount,\n\t\tNetAmount,\n\t\tItemTotalTax,\n\t\tVoidReasonID,\n\t\tComplimentID,\n\t\tBillNo,\n\t\tBillAmount,\n\t\tPax,\n\t\tTableId = TableID,\n\t\tKotTypeId = KOTTypeID,\n\t\tEmployeeId = EmployeeID,\n\t\tTotalTax,\n\t\tTotalDiscount,\n\t\tDiscountAfterPromotion,\n\t\tTotalRoundOff = RoundOffAmount,\n\t\tComplimentory,\n\t\tTotalTipAmount,\n\t\tGroupSizeId = GroupSizeID,\n\t\tCashID,\n\t\tCreditCardID,\n\t\tSettleDateTimeID = SettleDateTimeId,\n\t\tBillID,\n\t\tReservationID,\n\t\tDimFloorID,\n\t\tGuestID,\n\t\tDimBookerID,\n\t\tDimMealStructureId,\n\t\tReservationDateID,\n\t\tVisitsCount,\n\t\tDimEventID,\n\t\tDimFlagID,\n\t\tActualPax,\n\t\tDimStatusID,\n\t\tResvCancelID,\n\t\tDimReasonID,\n\t\tWalkInID,\n\t\tLastVisitedId,\n\t\tDaysNotVisitedID,\n\t\tVisitStatusID,\n\t\tGuestRatingID,\n\t\tReservationHourID,\n\t\tMealId = MealID,\n\t\tDimStyleofOperationID,\n\t\tDimDiscCardID,\n\t\tKioskID,\n\t\tUserID,\n\t\tVoidUserID,\n\t\tBillVoidDateId,\n\t\tWaiterId,\n\t\tBillKOTTypeId,\n\t\tBillMade_POSShiftId,\n\t\tVoidBillKotID\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> FactBillOrderVoidDetail"
		}
	}
}